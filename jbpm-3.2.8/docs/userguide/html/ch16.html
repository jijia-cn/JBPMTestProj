<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;16.&nbsp;Logging</title><meta name="generator" content="DocBook XSL Stylesheets V1.72.0"><link rel="start" href="index.html" title="JBoss jBPM - Workflow in Java"><link rel="up" href="index.html" title="JBoss jBPM - Workflow in Java"><link rel="prev" href="ch15s08.html" title="Mail server"><link rel="next" href="ch16s02.html" title="Log configurations"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter&nbsp;16.&nbsp;Logging</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch15s08.html">Prev</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="ch16s02.html">Next</a></td></tr></table><hr></div><div class="chapter" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a name="logging"></a>Chapter&nbsp;16.&nbsp;Logging</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="ch16.html#creationoflogs">Creation of logs</a></span></dt><dt><span class="section"><a href="ch16s02.html">Log configurations</a></span></dt><dt><span class="section"><a href="ch16s03.html">Log retrieval</a></span></dt><dt><span class="section"><a href="ch16s04.html">Database warehousing</a></span></dt></dl></div><p>The purpose of logging is to keep track of the history of a 
  process execution.  As the runtime data of a process execution changes, 
  all the delta's are stored in the logs.</p><p>Process logging, which is covered in this chapter, is not to be confused 
  with software logging.  Software logging traces the execution of a software 
  program (usually for debugging purposes).  Process logging traces the execution 
  of process instances.</p><p>There are various use cases for process logging information.  Most obvious is 
  the consulting of the process history by participants of a process execution.  
  </p><p>Another use case is 
  Business Activity Monitoring (BAM).  BAM will query or analyse the logs of process 
  executions to find usefull statistical information about the business process.  E.g.
  how much time is spend on average in each step of the process ?  Where are the 
  bottlenecks in the process ? ...  This information is key to implement real business 
  process management in an organisation.  Real business process management is about how 
  an organisation manages their processes, how these are supported by information technology
  *and* how these two improve the other in an iterative process.
  </p><p>Next use case is the undo functionality.  Process logs can be used to implement 
  the undo.  Since the logs contain the delta's of the runtime information, the logs can be 
  played in reverse order to bring the process back into a previous state.
  </p><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="creationoflogs"></a>Creation of logs</h2></div></div></div><p>Logs are produced by jBPM modules while they are running process executions.
    But also users can insert process logs.  A log entry is a java object that inherits from 
    <code class="literal">org.jbpm.logging.log.ProcessLog</code>.  Process log entries are added to 
    the <code class="literal">LoggingInstance</code>.  The <code class="literal">LoggingInstance</code> is an 
    optional extension of the <code class="literal">ProcessInstance</code>.
    </p><p>Various kinds of logs are generated by jBPM : graph execution logs, context logs 
    and task management logs.  For more information about the specific data contained in 
    those logs, we refer to the javadocs.  A good starting point is the class 
    <code class="literal">org.jbpm.logging.log.ProcessLog</code> since from that class you can navigate
    down the inheritance tree.</p><p>The <code class="literal">LoggingInstance</code> will collect all the log entries.  When
    the <code class="literal">ProcessInstance</code> is saved, all the logs in the <code class="literal">LoggingInstance</code>
    will be flushed to the database.  The <code class="literal">logs</code>-field of a <code class="literal">ProcessInstance</code> 
    is not mapped with hibernate to avoid that logs are retrieved from the database in each transactions.  
    Each <code class="literal">ProcessLog</code> is made in the context
    of a path of execution (<code class="literal">Token</code>) and hence, the <code class="literal">ProcessLog</code>
    refers to that token.  The <code class="literal">Token</code> also serves as an index-sequence generator 
    for the index of the <code class="literal">ProcessLog</code> in the <code class="literal">Token</code>.  This will 
    be important for log retrieval.  That way, logs that are produced in subsequent transactions
    will have sequential sequence numbers. (wow, that a lot of seq's in there :-s ).</p><p>The API method for adding process logs is the following.
    </p><pre class="programlisting">public class LoggingInstance extends ModuleInstance {
  ...
  public void addLog(ProcessLog processLog) {...}
  ...
}</pre><p>The UML diagram for logging information looks like this:</p><div class="figure"><a name="logging.model.image"></a><p class="title"><b>Figure&nbsp;16.1.&nbsp;The jBPM logging information class diagram</b></p><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/logging.model.gif" align="middle" alt="The jBPM logging information class diagram"></div></div></div><br class="figure-break"><p>A <code class="literal">CompositeLog</code>
    is a special kind of log entry.  It serves as a parent log for a number of child logs, 
    thereby creating the means for a hierarchical structure in the logs.
    The API for inserting a log is the following.</p><pre class="programlisting">public class LoggingInstance extends ModuleInstance {
  ...
  public void startCompositeLog(CompositeLog compositeLog) {...}
  public void endCompositeLog() {...}
  ...
}</pre><p>The <code class="literal">CompositeLog</code>s should always be called in a 
    <code class="literal">try-finally</code>-block to make sure that the hierarchical 
    structure of logs is consistent.  For example:</p><pre class="programlisting">startCompositeLog(new MyCompositeLog());
try {
  ...
} finally {
  endCompositeLog();
}</pre></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch15s08.html">Prev</a>&nbsp;</td><td width="20%" align="center">&nbsp;</td><td width="40%" align="right">&nbsp;<a accesskey="n" href="ch16s02.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Mail server&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Log configurations</td></tr></table></div></body></html>